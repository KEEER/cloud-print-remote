{% extends 'framework.html' %}

{% block title %} ä¸Šä¼ æ–‡ä»¶ | Cloud Print {% endblock title%}

{% block stylesheet%}
  <link rel="stylesheet" href="/static/css/index.css" />
{% endblock stylesheet %}

{% block content %}
  <div class="file-drop-container">
    <div class="file-drop-zone" id="file-zone" accept="application/pdf">
      <div class="printer-card">
        <img class="printer-card__logo" src="https://squoosh.app/logo.af355.svg" />
        <div class="printer-card__content">
          <h5 class="mdc-typography--headline5">ICCæ¥¼å››å±‚ä¸œä¾§</h5>
          <div class="printer-card__status">
            <span clas="mdc-typography--body1">çŠ¶æ€ï¼š </span>
            <div class="printer-status printer-status__unavaliable"></div>
            <span clas="mdc-typography--body1">ä¸å¯ç”¨</span>
          </div>
          <span clas="mdc-typography--body1">æè¿°ï¼šè¿™æ˜¯ä¸€å°æ‰“å°æœº</span>
        </div>
      </div>

      <h5 class="mdc-typography--headline5">
        æ‹–æ”¾æˆ–
        <button class="mdc-button" onclick="document.getElementById('file').click()">
          <span class="mdc-button__label">é€‰æ‹©</span>
        </button>
        ä¸€ä¸ªæ–‡ä»¶
      </h5>
        <h5 class="mdc-typography--headline5 file-drop__helper" id="upload-info">â˜ºï¸ æ‹–æ‹½æ–‡ä»¶åˆ°è¿™é‡Œ</h5>
    </div>
  </div>
  <input id="file" type="file" accept="application/pdf" style="display: none;"/>
{% endblock content %}
{% block script %}
  <script type="text/javascript">
    const dragAndDropZone = document.getElementById('file-zone')
    const infoBox = document.getElementById('upload-info')
    const file = document.getElementById('file')
    var t;
    function setMessage(message) {
      infoBox.style.opacity = 1;
			  infoBox.innerText = message;
    }

    dragAndDropZone.ondragover = dragAndDropZone.ondragenter = function(evt) {
			  evt.preventDefault();
			  dragAndDropZone.classList.add('file-drop-zone__focused');

			  infoBox.style.opacity = 0;
			};
			dragAndDropZone.ondragleave = function(evt) {
				evt.preventDefault();
				dragAndDropZone.classList.remove('file-drop-zone__focused');

        setMessage('â˜ºï¸ æ‹–æ‹½æ–‡ä»¶åˆ°è¿™é‡Œ');
			}
			dragAndDropZone.ondrop = function(evt) {
			  dragAndDropZone.classList.remove('file-drop-zone__focused');
			  console.log(evt.dataTransfer.files[0]);
			  t = evt.dataTransfer.files[0];
			  if (evt.dataTransfer.files[0].type !== 'application/pdf') {
				  evt.preventDefault();
				  setMessage('ğŸ’€ è¯·ä¸Šä¼  PDF æ–‡ä»¶');
				  return;
			  }
        // TODO: real upload and request part
        file.files = evt.dataTransfer.files
			  setMessage('ğŸ¤— å¥½å˜ï¼Œæ­£åœ¨ä¸Šä¼ '+evt.dataTransfer.files[0].name);
			  evt.preventDefault();
			};
      file.addEventListener('change', function(e) {
        console.log('Event change', e)
        t = file.files[0];
        console.log('file: ', t)
			  if (t.type !== 'application/pdf') {
				  setMessage('ğŸ’€ è¯·ä¸Šä¼  PDF æ–‡ä»¶');
				  return;
			  }
        setMessage('ğŸ¤— å¥½å˜ï¼Œæ­£åœ¨ä¸Šä¼ '+t.name);
      })
  </script>
{% endblock script%}
